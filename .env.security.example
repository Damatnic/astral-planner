# GUARDIAN SECURITY ENVIRONMENT CONFIGURATION
# Copy to .env.local and customize for your environment

# ===== CRITICAL SECURITY SETTINGS =====

# JWT Configuration (REQUIRED)
JWT_SECRET=your-super-secure-jwt-secret-at-least-32-characters-long
JWT_ISSUER=astral-chronos
JWT_AUDIENCE=astral-chronos-users
JWT_ALGORITHM=HS256

# Data Encryption Master Key (REQUIRED)
# Generate with: openssl rand -base64 32
GUARDIAN_MASTER_KEY=your-base64-encoded-master-key-for-data-encryption
JWT_SALT=your-unique-salt-for-jwt-key-derivation

# ===== PRODUCTION SECURITY SETTINGS =====

# Environment
NODE_ENV=production
FORCE_HTTPS=true

# Database Security
DATABASE_URL=postgresql://username:password@localhost:5432/astral_planner?sslmode=require
DB_SSL_MODE=require
DB_ENCRYPTION_AT_REST=true

# Redis Configuration (for rate limiting and caching)
REDIS_URL=redis://localhost:6379
REDIS_SSL=true
REDIS_AUTH_PASSWORD=your-redis-password

# ===== MONITORING & LOGGING =====

# Error Monitoring
SENTRY_DSN=your-sentry-dsn-for-error-tracking
SENTRY_ENVIRONMENT=production

# Security Monitoring
SECURITY_MONITORING_ENDPOINT=https://your-siem-endpoint.com
SECURITY_ALERT_EMAIL=security@yourdomain.com
SECURITY_WEBHOOK_URL=https://your-security-webhook.com

# ===== EXTERNAL SERVICES =====

# Email Service (for security notifications)
SMTP_HOST=your-smtp-host.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password
SMTP_FROM=security@yourdomain.com

# ===== SECURITY FEATURES =====

# Rate Limiting
RATE_LIMIT_REDIS_PREFIX=astral:rate_limit:
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Session Management
SESSION_TIMEOUT=86400000
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_SAME_SITE=strict

# CSRF Protection
CSRF_SECRET=your-csrf-secret-key
CSRF_COOKIE_NAME=_csrf

# Content Security Policy
CSP_REPORT_URI=https://your-domain.com/api/security/csp-report
CSP_REPORT_ONLY=false

# ===== COMPLIANCE SETTINGS =====

# Data Retention (in days)
DATA_RETENTION_DAYS=2555  # 7 years for compliance
LOG_RETENTION_DAYS=90
AUDIT_LOG_RETENTION_DAYS=2555

# Privacy Settings
GDPR_ENABLED=true
CCPA_ENABLED=true
DATA_EXPORT_ENABLED=true
DATA_DELETION_ENABLED=true

# ===== DEVELOPMENT OVERRIDES =====
# These settings should only be used in development

# Development mode settings (DO NOT USE IN PRODUCTION)
# DEBUG_MODE=false
# DISABLE_RATE_LIMITING=false
# DISABLE_CSRF=false
# ALLOW_HTTP=false

# ===== INFRASTRUCTURE SECURITY =====

# Network Security
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_CREDENTIALS=true

# File Upload Security
MAX_FILE_SIZE=10485760  # 10MB
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,text/plain

# API Security
API_VERSION=v1
API_RATE_LIMIT_ENABLED=true
API_AUTHENTICATION_REQUIRED=true

# Webhook Security
WEBHOOK_SECRET=your-webhook-signature-secret

# ===== BACKUP & RECOVERY =====

# Backup Configuration
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key
BACKUP_STORAGE_ENDPOINT=s3://your-backup-bucket
BACKUP_RETENTION_DAYS=90

# ===== AUDIT & COMPLIANCE =====

# Audit Configuration
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
COMPLIANCE_MODE=strict

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_NONCE_ENABLED=true

# ===== ADDITIONAL SECURITY SETTINGS =====

# Multi-Factor Authentication (if implemented)
# MFA_ENABLED=true
# MFA_ISSUER=Astral Chronos
# MFA_BACKUP_CODES_COUNT=10

# Single Sign-On (if implemented)
# SSO_ENABLED=false
# SAML_IDP_URL=
# OAUTH_CLIENT_ID=
# OAUTH_CLIENT_SECRET=

# Advanced Threat Protection
THREAT_DETECTION_ENABLED=true
GEO_BLOCKING_ENABLED=false
IP_WHITELIST_ENABLED=false

# Performance Security
DDOS_PROTECTION_ENABLED=true
REQUEST_SIZE_LIMIT=1048576  # 1MB
RESPONSE_TIME_LIMIT=30000   # 30 seconds

# ===== NOTES =====
# 1. All secrets should be randomly generated and unique
# 2. Use tools like `openssl rand -base64 32` to generate secure keys
# 3. Rotate secrets regularly (at least quarterly)
# 4. Never commit actual secrets to version control
# 5. Use environment-specific configurations
# 6. Test all security settings in staging before production
# 7. Monitor security logs regularly
# 8. Keep this file updated with new security requirements

# ===== SECURITY CHECKLIST =====
# □ All required environment variables are set
# □ All secrets are properly generated and secure
# □ Database connections use SSL
# □ Redis connections are authenticated
# □ Error monitoring is configured
# □ Security monitoring is active
# □ Rate limiting is enabled
# □ CSRF protection is active
# □ Content Security Policy is configured
# □ Security headers are enabled
# □ Audit logging is configured
# □ Backup encryption is enabled
# □ Compliance settings are appropriate
# □ File upload restrictions are in place
# □ Network security is configured
# □ Threat detection is enabled